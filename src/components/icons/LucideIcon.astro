---
import lucideStatic from 'lucide-static';

const { name, class: className = '', strokeWidth = 1.5 } = Astro.props;
// Convert kebab-case to PascalCase (e.g., "arrow-right" -> "ArrowRight")
const pascalName = name
  .split('-')
  .map(word => word.charAt(0).toUpperCase() + word.slice(1))
  .join('');
const svg = lucideStatic[pascalName];

if (!svg) {
  throw new Error(`Unknown Lucide icon: ${name} (tried: ${pascalName})`);
}

let html = svg;
if (className) {
  html = html.replace('<svg ', `<svg class="${className}" `);
}

if (html.includes('stroke-width=')) {
  html = html.replace(/stroke-width="[^"]*"/, `stroke-width="${strokeWidth}"`);
} else {
  html = html.replace('<svg ', `<svg stroke-width="${strokeWidth}" `);
}
---
<Fragment set:html={html} />
